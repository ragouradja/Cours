---
title: "variable"
author: "Ragousandirane"
date: "21/09/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
lambda = 5
```


```{r}
my_rpois_one <- function(lambda){
  u <- runif(1)
  x <- 0
  # u < ppois(x, lambda = lambda)
  while(u > ppois(x, lambda = lambda)){
    x <- x + 1
  }
  
  return(x)
}
```



```{r}
my_rpois_one(3.6)
```

```{r}
my_rpois <- function(n, lambda){
  vec <- rep(NA,length = n)
  
  for(i in 1:n){
    vec[i] <- my_rpois_one(lambda)
  }
  
  return(vec)
}
```



```{r}
n = 1000000
x <- my_rpois(n,2.8)
# plot car discrete
# frequence diag en baton
plot(table(x) / n)
```

# Mean : valeur proche du parametre
# Variance aussi car loi de poisson var = mean
```{r}
mean(x)
var(x)
```


# Surimposition des graphs
Génération de points de bonnes fréquences avec points
représenter la représentation graphique vs la théorie : dpois
```{r}
val_x <- 0:12
val_y <- dpois(val_x, lambda = 2.8) 
plot(table(x) / n)
lines(val_x, val_y)
points(val_x, val_y)

```



```{r}
my_rdiscret_one <- function(){
  x <- c(-3,15.2,7,1.3)
  p <- c(0.1,0.2,0.3,0.4)
  p_sum = cumsum(p)
  u <- runif(1)
  i <- 1
  while(u > p_sum[i]){
    i <- i + 1
  }
  
  return(x[i])
}

```



```{r}
my_rdiscret_one()
```



```{r}
my_rdiscret <- function(n){
  val_discret = rep(NA, length = n)
  
  for(i in 1:n){
    val_discret[i] = my_rdiscret_one()
  }
  return(val_discret)
}
```



```{r}
N = 100000
w = my_rdiscret(N)
plot(table(w) / N)
```



```{r}

```
