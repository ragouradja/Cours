# Fonction à étudier g(x)
On réimplemente la fonction g de l'énoncé
```{r}
g <- function(x){
  return ((exp(x) - 1 )/(exp(1) - 1))
}
```

# Visualisation de la fonction g
On choisit des valeurs de X allant de 0 à 2 pour visualiser la courbe de la fonction
```{r}
X <- seq(from = 0, to = 2, len = 100)
plot(X,g(X), type = "l")

```

# Aire sous la courbe selon l'énoncé et la fonction integrate de R
On récupère les solutions optimales pour les comparer à nos solutions calculées
```{r}
solution <- (exp(2) - 3) / (exp(1) - 1)
solution_R <- integrate(g, lower = 0, upper = 2)
print(solution)
print(solution_R)
```

# MC black and white
I <- m(b-a) * (ns/n)
ns : nombre de succès

On implemente la fonction qui va estimer l'aire sous la courbe par la méthode de MC BW.
On tire aléatoirement des points V et on détermine si ces points sont sous la courbe par le calcul : V <= g(U)
```{r}
estim_I <- function(n) {
  b <- 2
  a <- 0
  m <- g(2)
  v <- runif(n,min = a, max = m)
  u <- runif(n,min = a, max = b)
  points <- sum(ifelse(v <= g(u),1,0))
  I <- m*(b-a)*points/n
  return(I)
}
```


On obtient une valeur proche de la valeur optimale avec 100000 points
```{r}
estim_I(100000)
```

# MSE de l'estimateur MC BW
```{r}
mse_I <- function(n,solution_I,nrep){
  valeur_I <- c()
  for (run in 1:nrep) {
  valeur_I <- c(valeur_I, estim_I(n))
  }
  MSE <- mean((valeur_I - solution_I)**2)
  truehist(valeur_I)
  abline(v = solution_I, col = "red")
  title(main = paste("mse = ",MSE))
}
```

On obtient un MSE d'environ 0.012 et une moyenne des solutions calculées qui semblent être proches de la solution
```{r}
mse_I(1000,solution,1000)
```
# Echantillonnage simple

```{r}
estim_I_simple <- function(n){
  b <- 2
  a <- 0
  
  
  x <- runif(n,min = a, max = b)
  
  # I = (b-a)* E[g(X)]
  I_estim = (b - a) * mean(g(x))
  return(I_estim)
}
```


```{r}
estim_I_simple(1000)
```

```{r}
mse_I_simple <- function(n,solution_I,nrep){
  valeur_I_simple <- c()
  for (run in 1:nrep) {
  valeur_I_simple <- c(valeur_I_simple, estim_I_simple(n))
  }
  MSE <- mean((valeur_I_simple - solution_I)**2)
  truehist(valeur_I_simple)
  abline(v = solution_I, col = "red")
  title(main = paste("mse = ",MSE))
}
```

```{r}
mse_I_simple(1000,solution,1000)
```

dbeta : fonction de densité de loi beta
mais nous on multiplie par 2


